# 使用拦截器Interceptor

## 0.什么是拦截器

拦截器是一种请求预处理和后处理机制  , 在请求到达controller 之前 和 执行controller之后 , 插入自己的逻辑

## **1.为什么需要使用拦截器?**

因为需要对用户的登录状态进行确认.比如在游客模式下 , 可以访问博客 , 但是看不到登录信息 . 而登陆状态下可以看到登录信息 , 为了达到这个目的 , 对登录的状态进行校验

## **2.如何进行登录校验**

注册一个拦截器 , 用@Configuration注解标注配置类 , 继承WebMvcConfiguer . 

然后重写方法 , 把自定义的拦截器写入注册器 , 排除某些路径

自定义拦截器 : 

​	<1>定义请求到达controller之前的逻辑:

​			session中会携带用户信息 , 把用户从session中取出 , 进行校验是否存在 , 如果不存在就是未登录状			态 ,需要要求登录 . return false 强行登录 					

​	<2>controller执行之后的逻辑:

​			controller执行之后 ,请求结束时, 登录状态退出 , 需要把session会话保存的用户信息抹除 , 从threadLocal中删			除用户  . 

## 3. 为什么使用ThreadLocal?

​	javaweb中 tomcat会使用线程池来处理请求 . 每个http请求都会使用一个线程来处理 . threadLocal为每个线程提供了变量副本 , 保证了线程之间的隔离性 , 避免多线程并发访问时的数据安全问题

